---
title: "lab_34 md"
output: html_document
date: "2025-10-18"
---


Hecho con gusto por Carla Carolina P?rez Hern?ndez (UAEH)
Alumno: Luis Armando González Arellano

Laboratorio - MAPA DE CALOR -T?RMICO- with pheatmap
DATOS GENETICOS TOMADOS DE Sahir Bhatnagar.
PRACTICA DE CODERS

Objetivo: Realizar un heatmap con datos geneticos 
En este ejercicio vamos a:
1. Cargar nuestra matriz hipot?tica de datos y dataframes adicionales
2. Realizar varios heatmaps

Un mapa de calor es una representaci?n gr?fica de datos que utiliza un sistema de codificaci?n de colores para representar diferentes valores


Abrimos la paquetria previamente instalada 
```{r}
library(pheatmap)
```


cargamos los datos que ya están en el directorio
el archivo de genes lo queremos como matriz, los demás serán dataframe
```{r}
genes <- as.matrix(
  read.csv("heatmap_data.csv",
          sep = ",",
          header = T,
          row.names = 1))
annotation_row <-(
  read.csv("annotation_row.csv",
           sep = ",",
           header = T,
           row.names = 1))

annotation_col <- (
  read.csv("annotation_col.csv",
           sep = ",",
           header = T,
           row.names = 1))

```


Graficamos el  pheatmap
```{r}
pheatmap(genes)
```


hacmeos ajustes en el tamaño de la fuente
```{r}
pheatmap(genes, frontsize= 6 )

```


cluster by gene - groups of similar genes----LOS GENES ESTAN EN LOS RENGLONES
#POR DEFAULT CLUSTEA LOS RENGLONES y columnas, Esta vez vamos a indicar que no incluya el cluster de las columnas
```{r}
pheatmap(genes, frontsize= 6, cluster_rows = T, cluster_cols = F )

```


cambiamos para quitar el clusters de los renglones y pero que si genere el cluster de las columnas
```{r}
pheatmap(genes, frontsize= 6, cluster_rows = F, cluster_cols = T )

```

Generamos ambos 
```{r}
pheatmap(genes, frontsize= 6, cluster_rows = T, cluster_cols = T )

```

vamos a identificar patrones incluyendo las annotaciones de los renglones que tenemos en el data frame
```{r}
pheatmap(genes, frontsize= 6, cluster_rows = T, cluster_cols = T, annotation_row = annotation_row)

```


Se incluye anotaciones de las columnas y filas para identificar otro tipo de patrones
```{r}
pheatmap(genes, frontsize= 6, cluster_rows = T, cluster_cols = T, annotation_row = annotation_row, annotation_col = annotation_col)

```

#now have information about the drug and condition 

#GRAFICO COMPLETO G1 con un Título y quitando los clusters 
```{r}
pheatmap(genes, frontsize= 6, cluster_rows = T, cluster_cols = T, annotation_row = annotation_row, annotation_col = annotation_col, treeheight_row = 0, treeheight_col = 0, main = "expresion genetica")

```



#take a smaller subset 
```{r}
sub <- genes[c(1:5, 55:60), c(1:5, 20:35, 55:60)]

```

#graficamos con un subconjunto de datos 
```{r}
pheatmap(sub, frontsize= 6, cluster_rows = T, cluster_cols = T, annotation_row = annotation_row, annotation_col = annotation_col, treeheight_row = 0, treeheight_col = 0, main = "expresion genetica")

```

# con subset 2 -graficamos incluyendo otras caracteristicas (desplegamos los números) con el subconunto de datos
```{r}
pheatmap(sub, frontsize= 6, cluster_rows = T, cluster_cols = T, annotation_row = annotation_row, annotation_col = annotation_col, treeheight_row = 0, treeheight_col = 0, main = "expresion genetica", fontsize = 8, annotation_legend = FALSE, display_numbers = TRUE, fontsize_number = 6 )
```



cargamos la libreria de viridis, la cual es una paleta de colores especial con las opciones:viridis, magma, plasma, cividis, inferno
Y luego graficamos uando la paleta especial "viridis"
```{r}
library(viridis)

pheatmap(sub, frontsize= 6, cluster_rows = T, cluster_cols = T, annotation_row = annotation_row,
         annotation_col = annotation_col, treeheight_row = 0, treeheight_col = 0,
         main = "expresion genetica", fontsize = 8, annotation_legend = FALSE, display_numbers = TRUE,
         fontsize_number = 6, col= viridis_pal(option = "viridis") (6))

```



# elementos adicionales 
```{r}
dist(sub)
pheatmap(cor(sub))
trans <- t(sub)

pheatmap(cor(trans))
```

